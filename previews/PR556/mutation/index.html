<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Mutation · BioMakie.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BioMakie.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../usage/">Usage</a></li><li><a class="tocitem" href="../alphashape/">Mesh</a></li><li><a class="tocitem" href="../infotext/">Info Text</a></li><li><a class="tocitem" href="../msaselection/">MSA Selection</a></li><li class="is-active"><a class="tocitem" href>Mutation</a><ul class="internal"><li><a class="tocitem" href="#Load-BioMakie-and-ProtoSyn"><span>Load BioMakie and ProtoSyn</span></a></li><li><a class="tocitem" href="#Prepare-the-structure"><span>Prepare the structure</span></a></li><li><a class="tocitem" href="#Get-plotting-data-for-the-Pose-and-plot-it"><span>Get plotting data for the Pose and plot it</span></a></li><li><a class="tocitem" href="#Prepare-the-structure-2"><span>Prepare the structure</span></a></li><li><a class="tocitem" href="#Mutate-the-structure"><span>Mutate the structure</span></a></li></ul></li><li><a class="tocitem" href="../API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Mutation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Mutation</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="ProtoSyn-Protein-Mutation"><a class="docs-heading-anchor" href="#ProtoSyn-Protein-Mutation">ProtoSyn Protein Mutation</a><a id="ProtoSyn-Protein-Mutation-1"></a><a class="docs-heading-anchor-permalink" href="#ProtoSyn-Protein-Mutation" title="Permalink"></a></h1><p>In this demo we can use ProtoSyn to mutate amino acids. Different rotamers can be selected for the mutated residue. To use ProtoSyn you currently have to use a workaround.</p><h2 id="Load-BioMakie-and-ProtoSyn"><a class="docs-heading-anchor" href="#Load-BioMakie-and-ProtoSyn">Load BioMakie and ProtoSyn</a><a id="Load-BioMakie-and-ProtoSyn-1"></a><a class="docs-heading-anchor-permalink" href="#Load-BioMakie-and-ProtoSyn" title="Permalink"></a></h2><p>Download the protosyn source code from the src directory of BioMakie and <code>include</code> it. This should install a few packages (SplitApplyCombine, Colors, Meshes, GeometryBasics, OrderedCollections, Distances) and then import ProtoSyn.</p><pre><code class="language-julia hljs">using BioMakie
using GLMakie

BioMakie.getprotosyn()
include(&quot;protosyn.jl&quot;)</code></pre><h2 id="Prepare-the-structure"><a class="docs-heading-anchor" href="#Prepare-the-structure">Prepare the structure</a><a id="Prepare-the-structure-1"></a><a class="docs-heading-anchor-permalink" href="#Prepare-the-structure" title="Permalink"></a></h2><p>To simplify things, we will load a structure with BioStructures and save chain &quot;A&quot; as a PDB file. Then we will load the PDB file with ProtoSyn.</p><pre><code class="language-julia hljs">using BioStructures
struc = retrievepdb(&quot;2vb1&quot;)
chn = collectresidues(struc[1][&quot;A&quot;], standardselector)
writepdb(&quot;2vb1x.pdb&quot;, chn)

pose = ProtoSyn.Peptides.load(&quot;2vb1x.pdb&quot;; bonds_by_distance=true) |&gt; Observable</code></pre><h2 id="Get-plotting-data-for-the-Pose-and-plot-it"><a class="docs-heading-anchor" href="#Get-plotting-data-for-the-Pose-and-plot-it">Get plotting data for the Pose and plot it</a><a id="Get-plotting-data-for-the-Pose-and-plot-it-1"></a><a class="docs-heading-anchor-permalink" href="#Get-plotting-data-for-the-Pose-and-plot-it" title="Permalink"></a></h2><pre><code class="language-julia hljs">pdata = plottingdata(pose)
fig = Figure()
_plotstruc!(fig, pdata)</code></pre><p><img src="../assets/wildtypearg.png" alt="wildtypearg"/></p><h2 id="Prepare-the-structure-2"><a class="docs-heading-anchor" href="#Prepare-the-structure-2">Prepare the structure</a><a class="docs-heading-anchor-permalink" href="#Prepare-the-structure-2" title="Permalink"></a></h2><p>We can use <code>diagnose</code> to get an idea of what is missing and of inconsistencies in the structure.</p><pre><code class="language-julia hljs">ProtoSyn.Peptides.diagnose(pose[])</code></pre><p>We have several issues, including charges, naming, and caps, which are the terminal hydrogens. We can use the following functions to address these issues. First we load the library of amino acids, to get the Peptide/protein-specific data, instead of the default generic data.</p><pre><code class="language-julia hljs">res_lib = ProtoSyn.load_grammar_from_file(ProtoSyn.resource_dir*&quot;/Peptides/grammars.yml&quot;, &quot;default&quot;)
ProtoSyn.Peptides.cap!(pose[])
ProtoSyn.Peptides.assign_default_atom_names!(pose[])
ProtoSyn.sort_atoms_by_graph!(pose[])
ProtoSyn.Peptides.Calculators.Electrostatics.assign_default_charges!(pose[], res_lib)

ProtoSyn.Peptides.diagnose(pose[])</code></pre><p>Now the issues should say <code>OK</code>, except for the atom-level graph. We can ignore this for now. This <code>fixpose!</code> function below may be convenient for syncing and correcting the structure after making changes. Using <code>pose[] = pose[]</code> can force Makie to update the pose/figure.</p><pre><code class="language-julia hljs">function fixpose!(pose::Observable; res_lib=ProtoSyn.load_grammar_from_file(ProtoSyn.resource_dir*&quot;/Peptides/grammars.yml&quot;, &quot;default&quot;))
    ProtoSyn.Peptides.cap!(pose[])
    ProtoSyn.Peptides.assign_default_atom_names!(pose[])
    ProtoSyn.sort_atoms_by_graph!(pose[])
    ProtoSyn.Calculators.Electrostatics.assign_default_charges!(pose[],res_lib)
    ProtoSyn.Peptides.sync!(pose[])
    pose[] = pose[]
end</code></pre><h2 id="Mutate-the-structure"><a class="docs-heading-anchor" href="#Mutate-the-structure">Mutate the structure</a><a id="Mutate-the-structure-1"></a><a class="docs-heading-anchor-permalink" href="#Mutate-the-structure" title="Permalink"></a></h2><p>Get information about a residue. In this example we will use residue 128 because it is easy to find on the structure. The long side chain of this arginine extends outward the furthest.</p><pre><code class="language-julia hljs">pose[].graph[1][128]</code></pre><p>Next lets try mutating it to tyrosine. We can use the <code>mutate!</code> function to do this. Combine it with <code>fixpose!</code> to get the updated structure. You should see the side chain change into the phenol ring of tyrosine.</p><pre><code class="language-julia hljs">ProtoSyn.Peptides.mutate!(pose[], pose[].graph[1][128], res_lib, seq&quot;Y&quot;)
fixpose!(pose)</code></pre><p><img src="../assets/mutanttyr.png" alt="mutanttyr"/></p><p>To choose different rotamers/orientations, we can use the rotamer library. ProtoSyn provides a stack of the most likely rotamers based on the dihedral angles of the residue.</p><pre><code class="language-julia hljs">rot_lib = ProtoSyn.Peptides.load_dunbrack()
phi = ProtoSyn.getdihedral(pose[].state, ProtoSyn.Peptides.phi(pose[].graph[1][128]))
psi = ProtoSyn.getdihedral(pose[].state, ProtoSyn.Peptides.psi(pose[].graph[1][128]))
stack = rot_lib[&quot;TYR&quot;][phi, psi]

ProtoSyn.Peptides.apply!(pose[].state, stack[3], pose[].graph[1][128])
fixpose!(pose)</code></pre><p><img src="../assets/mutanttyrrotamer.png" alt="mutanttyrrotamer"/></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../msaselection/">« MSA Selection</a><a class="docs-footer-nextpage" href="../API/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Saturday 12 August 2023 05:10">Saturday 12 August 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
